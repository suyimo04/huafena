import{d as V,u as x,c as h,a as n,b as o,w as t,e as R,f as c,r as l,g as C,h as L,o as U,i as q,j as f,k as z,E as B,l as E,_ as N}from"./index-Dmpy0hQc.js";import{i as S}from"./axios-DYop8cuN.js";const T={class:"login-page"},A={class:"login-card theme-card"},F={class:"login-footer"},K=V({__name:"LoginPage",setup(M){const g=C(),_=L(),i=x(),u=f(),a=f(!1),s=z({username:"",password:""}),b={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]};async function d(){if(!(!u.value||!await u.value.validate().catch(()=>!1))){a.value=!0;try{const e=await S.post("/auth/login",{username:s.username,password:s.password});i.setToken(e.data.token),i.loadUserFromToken(),B.success("登录成功");const r=_.query.redirect||E(i.role);g.push(r)}catch{}finally{a.value=!1}}}return(v,e)=>{const r=l("el-input"),p=l("el-form-item"),w=l("el-button"),k=l("el-form"),y=l("router-link");return U(),h("div",T,[n("div",A,[e[5]||(e[5]=n("h2",{class:"login-title"},"花粉小组管理系统",-1)),e[6]||(e[6]=n("p",{class:"login-subtitle"},"请登录您的账户",-1)),o(k,{ref_key:"formRef",ref:u,model:s,rules:b,"label-position":"top",onSubmit:R(d,["prevent"])},{default:t(()=>[o(p,{label:"用户名",prop:"username"},{default:t(()=>[o(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.username=m),placeholder:"请输入用户名","prefix-icon":"User",size:"large",disabled:a.value},null,8,["modelValue","disabled"])]),_:1}),o(p,{label:"密码",prop:"password"},{default:t(()=>[o(r,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=m=>s.password=m),type:"password",placeholder:"请输入密码","prefix-icon":"Lock",size:"large","show-password":"",disabled:a.value,onKeyup:q(d,["enter"])},null,8,["modelValue","disabled"])]),_:1}),o(p,null,{default:t(()=>[o(w,{type:"primary",size:"large",class:"login-btn",loading:a.value,onClick:d},{default:t(()=>[...e[2]||(e[2]=[c(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),n("div",F,[e[4]||(e[4]=c(" 还没有账户？ ",-1)),o(y,{to:"/register",class:"link-accent"},{default:t(()=>[...e[3]||(e[3]=[c("立即注册",-1)])]),_:1})])])])}}}),I=N(K,[["__scopeId","data-v-50a44b93"]]);export{I as default};
